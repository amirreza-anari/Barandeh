package ir.amirrezaanari.barandehplanning


import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import ir.amirrezaanari.barandehplanning.api_part.fetchAIResponse
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch

class AiViewModel : ViewModel() {
    private val _aiResponse = MutableStateFlow("")
    val aiResponse = _aiResponse.asStateFlow()

    private val _isLoading = MutableStateFlow(false)
    val isLoading = _isLoading.asStateFlow()

    private val _currentFact = MutableStateFlow("")
    val currentFact = _currentFact.asStateFlow()

    private val facts = listOf(
        "می‌دونی؟ اگه اهداف‌ت رو بنویسی، احتمال موفقیت‌ت تا ۴۲٪ می‌ره بالا!",
        "خب رفیق، بهترین زمان برای برنامه‌ریزی روزانه، شب قبل از خوابه!",
        "می‌دونستی آدمای موفق معمولاً روزشون رو به بخش‌های ۹۰ دقیقه‌ای تقسیم می‌کنن؟",
        "یه چیز جالب! مغز ما بین ساعت ۱۰ تا ۱۲ صبح بیشترین بازدهی رو داره.",
        "حواست باشه! انجام چندتا کار همزمان می‌تونه تا ۴۰٪ بهره‌وری‌ت رو کم کنه.",
        "ببین، اگه هر ۲۵ دقیقه یه استراحت ۵ دقیقه‌ای داشته باشی، بازدهی‌ت تا ۳۰٪ بیشتر می‌شه!",
        "یه نکته طلایی! اگه قبل از خواب اهداف روزانه‌ت رو مرور کنی، احتمال اینکه بهشون برسی بیشتر می‌شه.",
        "می‌دونی؟ اگه فقط روی یه کار تمرکز کنی، ۳ برابر سریع‌تر انجامش می‌دی.",
        "نوشتن برنامه روزانه می‌تونه استرست رو تا ۶۰٪ کم کنه. امتحانش کن!",
        "ورزش صبحگاهی بازدهی مغزت رو تا ۲۰٪ می‌بره بالا، خیلی خفنه نه؟",
        "می‌دونی؟ اگه درست زمانت رو مدیریت کنی، می‌تونی ۲ ساعت وقت اضافه گیر بیاری!",
        "کارای مهم رو اول روز انجام بده، احتمال اینکه تمومشون کنی ۳ برابر بیشتر می‌شه.",
        "یه برنامه مشخص کیفیت خوابت رو تا ۴۰٪ بهتر می‌کنه، پس برنامه‌ریزی کن!",
        "هر روز سه تا هدف اصلی بنویس، اینطوری شانس موفقیت‌ت دو برابر می‌شه!",
        "تنظیم ساعت خواب منظم، بهره‌وری‌ت رو تا ۵۰٪ بیشتر می‌کنه. حتما امتحانش کن!",
        "یه نکته باحال! صبحا بهترین زمان برای تصمیم‌گیری‌های مهمه.",
        "هفته‌ای برنامه‌ریزی کن، می‌تونی تا ۳۰٪ توی زمانت صرفه‌جویی کنی!",
        "مغزت بعد از ۹۰ دقیقه کار سنگین، واقعاً نیاز به یه استراحت داره، بهش اهمیت بده!",
        "آب کافی بخور، تمرکز و بهره‌وری‌ت تا ۲۵٪ بیشتر می‌شه. ساده و مؤثر!",
        "می‌دونی محیط کار مرتب می‌تونه بازدهی‌ت رو تا ۳۵٪ ببره بالا؟ مرتب‌سازی کن!"
    )


    fun clearResponse() {
        _aiResponse.value = ""
    }

    fun updateFact() {
        _currentFact.value = facts.random()
    }

    fun getAiResponse() {
        _isLoading.value = true
        viewModelScope.launch {
            val response = fetchAIResponse(
                "2/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "2 تا 4: درس\n" +
                        "4 تا 5: ورزش\n" +
                        "6 تا 8: کارهای پروژه\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "3 تا 4: درس\n" +
                        "5 تا 6: ورزش\n" +
                        "7 تا 8: استراحت\n" +
                        "3/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "10 تا 12: مطالعه کتاب\n" +
                        "12 تا 1: ناهار و استراحت\n" +
                        "3 تا 5: کار با کامپیوتر\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "11 تا 12: مطالعه کتاب\n" +
                        "12 تا 2: استراحت و ناهار\n" +
                        "4 تا 5: بازی با کامپیوتر\n" +
                        "4/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "9 تا 11: مرتب کردن اتاق\n" +
                        "11 تا 12: تمرین زبان انگلیسی\n" +
                        "5 تا 6: تماشای فیلم\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "9:30 تا 11:30: مرتب کردن اتاق\n" +
                        "12 تا 1: تمرین زبان انگلیسی\n" +
                        "6 تا 8: تماشای سریال"
            )
            _aiResponse.value = response
            _isLoading.value = false
        }
    }
}