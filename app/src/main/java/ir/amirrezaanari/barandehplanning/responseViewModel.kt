package ir.amirrezaanari.barandehplanning


import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import ir.amirrezaanari.barandehplanning.api_part.fetchAIResponse
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch

class AiViewModel : ViewModel() {
    private val _aiResponse = MutableStateFlow("")
    val aiResponse = _aiResponse.asStateFlow()

    private val _isLoading = MutableStateFlow(false)
    val isLoading = _isLoading.asStateFlow()

    private val _currentFact = MutableStateFlow("")
    val currentFact = _currentFact.asStateFlow()

    private val facts = listOf(
        "آیا میدانستید مطالعات نشان می‌دهد نوشتن اهداف، شانس موفقیت را تا ۴۲٪ افزایش می‌دهد؟",
        "آیا میدانستید بهترین زمان برنامه‌ریزی روزانه، شب قبل از خواب است؟",
        "آیا میدانستید افراد موفق معمولاً روز خود را به بخش‌های ۹۰ دقیقه‌ای تقسیم می‌کنند؟",
        "آیا میدانستید مغز انسان در ساعات ۱۰ تا ۱۲ صبح بیشترین بازدهی را دارد؟",
        "آیا میدانستید انجام چند کار همزمان می‌تواند تا ۴۰٪ از بهره‌وری شما را کاهش دهد؟",
        "آیا میدانستید استراحت‌های ۵ دقیقه‌ای هر ۲۵ دقیقه، بازدهی را تا ۳۰٪ افزایش می‌دهد؟",
        "آیا میدانستید خواندن اهداف روزانه قبل از خواب شب، احتمال تحقق آنها را افزایش می‌دهد؟",
        "آیا میدانستید تمرکز کامل روی یک کار، ۳ برابر سریع‌تر از انجام همزمان چند کار است؟",
        "آیا میدانستید نوشتن برنامه روزانه می‌تواند استرس را تا ۶۰٪ کاهش دهد؟",
        "آیا میدانستید ورزش صبحگاهی بازدهی مغز را تا ۲۰٪ افزایش می‌دهد؟",
        "آیا میدانستید مدیریت زمان مؤثر می‌تواند ۲ ساعت از روز شما را آزاد کند؟",
        "آیا میدانستید انجام کارهای مهم در ابتدای روز، احتمال تکمیل آنها را ۳ برابر می‌کند؟",
        "آیا میدانستید داشتن برنامه مشخص، کیفیت خواب را تا ۴۰٪ بهبود می‌بخشد؟",
        "آیا میدانستید نوشتن ۳ هدف اصلی برای هر روز، احتمال موفقیت را دو برابر می‌کند؟",
        "آیا میدانستید تنظیم ساعت خواب منظم، بهره‌وری روزانه را تا ۵۰٪ افزایش می‌دهد؟",
        "آیا میدانستید مطالعات نشان می‌دهد صبح‌ها بهترین زمان برای تصمیم‌گیری‌های مهم است؟",
        "آیا میدانستید برنامه‌ریزی هفتگی می‌تواند تا ۳۰٪ در زمان شما صرفه‌جویی کند؟",
        "آیا میدانستید مغز انسان پس از ۹۰ دقیقه کار مداوم نیاز به استراحت دارد؟",
        "آیا میدانستید نوشیدن آب کافی می‌تواند تمرکز و بهره‌وری را تا ۲۵٪ افزایش دهد؟",
        "آیا میدانستید داشتن محیط کار مرتب، بازدهی را تا ۳۵٪ بالا می‌برد؟"
    )

    fun clearResponse() {
        _aiResponse.value = ""
    }

    fun updateFact() {
        _currentFact.value = facts.random()
    }

    fun getAiResponse() {
        _isLoading.value = true
        viewModelScope.launch {
            val response = fetchAIResponse(
                "2/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "2 تا 4: درس\n" +
                        "4 تا 5: ورزش\n" +
                        "6 تا 8: کارهای پروژه\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "3 تا 4: درس\n" +
                        "5 تا 6: ورزش\n" +
                        "7 تا 8: استراحت\n" +
                        "3/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "10 تا 12: مطالعه کتاب\n" +
                        "12 تا 1: ناهار و استراحت\n" +
                        "3 تا 5: کار با کامپیوتر\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "11 تا 12: مطالعه کتاب\n" +
                        "12 تا 2: استراحت و ناهار\n" +
                        "4 تا 5: بازی با کامپیوتر\n" +
                        "4/9/1403:\n" +
                        "برنامه ریخته شده:\n" +
                        "\n" +
                        "9 تا 11: مرتب کردن اتاق\n" +
                        "11 تا 12: تمرین زبان انگلیسی\n" +
                        "5 تا 6: تماشای فیلم\n" +
                        "برنامه انجام شده:\n" +
                        "\n" +
                        "9:30 تا 11:30: مرتب کردن اتاق\n" +
                        "12 تا 1: تمرین زبان انگلیسی\n" +
                        "6 تا 8: تماشای سریال"
            )
            _aiResponse.value = response
            _isLoading.value = false
        }
    }
}